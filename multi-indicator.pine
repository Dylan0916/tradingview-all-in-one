// This Pine Script™ code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © TradingView Custom Indicator

//@version=5
indicator("All-in-One (EMA + WMA + MACD)", overlay=false)

// ==================== EMA Settings ====================
emaGroup = "EMA Settings"
showEma1 = input.bool(true, "Show EMA 1", group=emaGroup)
ema1Length = input.int(20, "EMA 1 Length", minval=1, group=emaGroup)

showEma2 = input.bool(true, "Show EMA 2", group=emaGroup)
ema2Length = input.int(50, "EMA 2 Length", minval=1, group=emaGroup)

showEma3 = input.bool(true, "Show EMA 3", group=emaGroup)
ema3Length = input.int(100, "EMA 3 Length", minval=1, group=emaGroup)

showEma4 = input.bool(true, "Show EMA 4", group=emaGroup)
ema4Length = input.int(200, "EMA 4 Length", minval=1, group=emaGroup)

// ==================== WMA Settings ====================
wmaGroup = "WMA Settings"
showWma = input.bool(true, "Show WMA", group=wmaGroup)
wmaLength = input.int(300, "WMA Length", minval=1, group=wmaGroup)

// ==================== MACD Settings ====================
macdGroup = "MACD Settings"
showMacd = input.bool(true, "Show MACD", group=macdGroup)
macdFastLength = input.int(12, "Fast Length", minval=1, group=macdGroup)
macdSlowLength = input.int(26, "Slow Length", minval=1, group=macdGroup)
macdSignalLength = input.int(9, "Signal Length", minval=1, group=macdGroup)
macdSource = input.source(close, "MACD Source", group=macdGroup)

// ==================== EMA Calculations & Plots (Main Chart) ====================
ema1 = ta.ema(close, ema1Length)
ema2 = ta.ema(close, ema2Length)
ema3 = ta.ema(close, ema3Length)
ema4 = ta.ema(close, ema4Length)

// Color and width are configured in "Style" tab, not "Inputs"
plot(showEma1 ? ema1 : na, "EMA 1", #00bcd4, 1, force_overlay=true)
plot(showEma2 ? ema2 : na, "EMA 2", #ff9800, 1, force_overlay=true)
plot(showEma3 ? ema3 : na, "EMA 3", #ab47bc, 1, force_overlay=true)
plot(showEma4 ? ema4 : na, "EMA 4", #ef5350, 4, force_overlay=true)

// ==================== WMA Calculations & Plots (Main Chart) ====================
wma = ta.wma(close, wmaLength)
plot(showWma ? wma : na, "WMA 300", #4caf50, 2, force_overlay=true)

// ==================== MACD Calculations ====================
[macdLine, signalLine, histLine] = ta.macd(macdSource, macdFastLength, macdSlowLength, macdSignalLength)

// Histogram color (green when rising, red when falling)
histColor = histLine >= histLine[1] ? #26A69A : #EF5350

// Plot MACD (using original values without normalization)
plot(showMacd ? histLine : na, "MACD Histogram", histColor, style=plot.style_columns)
plot(showMacd ? macdLine : na, "MACD Line", #2962FF, 1)
plot(showMacd ? signalLine : na, "MACD Signal", #FF6D00, 1)

// ==================== Reference Lines ====================
hline(0, "MACD Zero Line", color.gray, hline.style_dashed)
